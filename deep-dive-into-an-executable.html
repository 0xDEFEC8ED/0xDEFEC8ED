<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Deep dive into an executable - Diary of a Cybersec Enthusiast</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="/deep-dive-into-an-executable.html">

        <meta name="author" content="samarth" />
        <meta name="keywords" content="reverse-engineering" />
        <meta name="description" content="When I was in middle school, I was introduced to this new kind of magical number system called &#34;binary&#34;. Since then, I have always been facinated by 0&#39;s and 1&#39;s. I always wondered how different combinations of just 2 possibilities ccould build something so complex and beautiful as the internet …" />

        <meta property="og:site_name" content="Diary of a Cybersec Enthusiast" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Deep dive into an executable"/>
        <meta property="og:url" content="/deep-dive-into-an-executable.html"/>
        <meta property="og:description" content="When I was in middle school, I was introduced to this new kind of magical number system called &#34;binary&#34;. Since then, I have always been facinated by 0&#39;s and 1&#39;s. I always wondered how different combinations of just 2 possibilities ccould build something so complex and beautiful as the internet …"/>
        <meta property="article:published_time" content="2020-04-11" />
            <meta property="article:section" content="reverse-engineering" />
            <meta property="article:tag" content="reverse-engineering" />
            <meta property="article:author" content="samarth" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="/theme/css/bootstrap.darkly.min.css" type="text/css"/>
    <link href="/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="/theme/css/style.css" type="text/css"/>
        <link href="/static/css/custom.css" rel="stylesheet">



</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="/" class="navbar-brand">
Diary of a Cybersec Enthusiast            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li >
                            <a href="/category/misc.html">Misc</a>
                        </li>
                        <li class="active">
                            <a href="/category/reverse-engineering.html">Reverse-engineering</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="/deep-dive-into-an-executable.html"
                       rel="bookmark"
                       title="Permalink to Deep dive into an executable">
                        Deep dive into an executable
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2020-04-11T19:00:00+05:30"> Sat 11 April 2020</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="/tag/reverse-engineering.html">reverse-engineering</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>When I was in middle school, I was introduced to this new kind of magical number system called "binary". Since then, I have always been facinated by 0's and 1's. I always wondered how different combinations of just 2 possibilities ccould build something so complex and beautiful as the internet. I soon began to understand how things needed to be planned out before you start to build it. Reverse-Engineering is different. It needs practice. It requires experience. And you can never say that you've had enough of both to say that you are good at it.</p>
<h3>What is a file?</h3>
<p>It is easy to define a file in terms of <a href="https://en.wikipedia.org/wiki/Linux">Linux</a>. - everything in linux is a file.
<a href="http://man7.org/linux/man-pages/man5/elf.5.html">ELF</a> is a File standard that is used to define an executable file in linux.
in simpler terms, executable files are the files that are coded to perform an action upon execution. It is a standard binary format for Linux and Unix-like systems on x86 processors. ELF64 is the revised standard for systems on x64 processors.</p>
<p>Again, in linux terms, extensions like ".exe" are useless. But for simplicity, I would like some regular users to associate an executable file with files that end with .so, .o, .bin, .elf and even .exe.</p>
<p>A file is simply an abstract object filled with chunks of 0's and 1's that might not make sense when looked under a microscope, but when you will zoom out a little, it will begin to make patterns. Initially those patterns might seem too complex and tangled to be designed by a human mind, but that is the true beauty that is truly facinating.</p>
<p>To understand the what we will be trying to achieve in this post, I will compile a simple C program and try to disect it using tools like hexeditor and Ghidra which can be found in either github, or standard repositories of whichever linux distro suits you taste.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
    <span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;h&#39;</span><span class="p">;</span>
    <span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span>
    <span class="n">buffer</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;c&#39;</span><span class="p">;</span>
    <span class="n">buffer</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;k&#39;</span><span class="p">;</span>
    <span class="n">buffer</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;t&#39;</span><span class="p">;</span>
    <span class="n">buffer</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;h&#39;</span><span class="p">;</span>
    <span class="n">buffer</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;e&#39;</span><span class="p">;</span>
    <span class="n">buffer</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;p&#39;</span><span class="p">;</span>
    <span class="n">buffer</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;l&#39;</span><span class="p">;</span>
    <span class="n">buffer</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span>
    <span class="n">buffer</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;n&#39;</span><span class="p">;</span>    
    <span class="n">buffer</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;e&#39;</span><span class="p">;</span>
    <span class="n">buffer</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;t&#39;</span><span class="p">;</span>
    <span class="n">buffer</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">input</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
    <span class="kt">char</span> <span class="n">useless</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;hacktheplanet&quot;</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Enter the password: &quot;</span><span class="p">);</span>
    <span class="n">fgets</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">strncmp</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;This is the secret Flag</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Access denied!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;}</span>
</code></pre></div>


<p>Compiling the above code using gcc,</p>
<div class="highlight"><pre><span></span><code>gcc <span class="m">1</span>.c -o out
</code></pre></div>


<p><img alt="redacted" src="/static/images/uc.png" title="Under Construction"></p>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://github.com/samarthkathal"><i class="fa fa-github-square fa-lg"></i> GitHub</a></li>
    <li class="list-group-item"><a href="https://twitter.com/samarth_kathal"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
    <li class="list-group-item"><a href="https://www.instagram.com/samarth.kathal/"><i class="fa fa-instagram fa-lg"></i> Instagram</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Categories -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Categories</span></h4>
  <ul class="list-group" id="categories">
    <li class="list-group-item">
      <a href="/category/misc.html"><i class="fa fa-folder-open fa-lg"></i>misc</a>
    </li>
    <li class="list-group-item">
      <a href="/category/reverse-engineering.html"><i class="fa fa-folder-open fa-lg"></i>reverse-engineering</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Categories -->

<!-- Sidebar/Links -->
<li class="list-group-item">
  <h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
  <ul class="list-group" id="links">
    <li class="list-group-item">
      <a href="http://getpelican.com/" target="_blank">Pelican</a>
    </li>
    <li class="list-group-item">
      <a href="http://python.org/" target="_blank">Python.org</a>
    </li>
    <li class="list-group-item">
      <a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a>
    </li>
    <li class="list-group-item">
      <a href="#" target="_blank">You can modify those links in your config file</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Links -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container-fluid">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2020 samarth
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="/theme/js/respond.min.js"></script>




</body>
</html>